# 《系统架构师》笔记

## 信息系统基础知识

### 企业信息化

企业信息化方法主要包括 **业务流程重构**、**核心业务应用**、**信息系统建设**、**主题数据库**、**资源管理**和**人力资本投资方法**。

### 管理创新

管理创新是按照市场发展的要求，对企业现有的管理流程重新整合，从作为管理核心的财务、物料管理，转向技术、物资、人力资源的管理，并延伸到企业技术创新、工艺设计、产品设计、生产制造过程的管理，进而还要扩展到客户关系管理、供应链管理乃至发展到电子商务。

### 关键成功因素法

该方法能够帮助企业找到影响系统成功的关键因素，通过分析来确定企业的信息需求，从而为管理部门控制信息技术及其处理过程提供实施指南。

关键成功因素法通过对关键成功因素的识别，找出实现目标所需要的关键信息集合，从而确定系统开发的优先次序。

关键成功因素来源于**组织的目标**，通过**组织的目标分解**和**关键成功因素识别**、**性能指标识别**，一直到产生数据字典。

## 软件架构设计

软件架构设计包括**提出架构模型**、**产生架构设计**和**进行设计评审**等活动，是一个迭代的过程。架构设计**主要关注软件组件的结构、属性和交互作用**，并通过多种**视图**全面描述特定系统的架构。

## 软件架构风格

软件架构风格是描述某一**特定应用领域**中**系统组织方式的惯用模式**。一个体系结构定义了一个**词汇表**和一组**约束**。架构风格反映领域中众多系统所共有的结构和语义特征。

### C2 体系结构风格

C2 体系结构风格可以概括为：通过连接件绑定在一起的按照一组规则运作的**并行构件网络**。

C2 风格中的系统组织规则如下：

1. 系统中的构件和连接件都有一个顶部和一个底部；
2. 构件的顶部应连接到某连接件的底部，构件的底部则应连接到某连接件的顶部，而构件与构件之间的直接连接是不允许的；
3. 一个连接件可以和任意数目的其他构件和连接件连接；
4. 当两个连接件进行直接连接时，必须由其中一个的底部到另一个的顶部。

### 面向构件的编程(Component-Oriented Programming，COP)

面向构件的编程(Component-Oriented Programming，COP)关注于如何支持建立面向构件的解决方案。基于一般 OOP 风格，面向构件的编程需要下列基本的支持：**多态性(可替代性)**、**模块封装性(高层次信息的隐藏)**、**后期的绑定和装载(部署独立性)**和**安全性(类型和模块安全性)**。

### 解释器风格

解释器是一个**用来执行其他程序**的程序。解释器可针对不同的硬件平台实现一个虚拟机，**将高抽象层次的程序翻译为低抽象层次所能理解的指令**，以消除在程序语言与硬件之间存在的语义差异。

### 管道一过滤器风格

在管道一过滤器风格的软件体系结构中，**每个构件都有一组输入和输出，构件读输入的数据流，经过内部处理，然后产生输出数据流**。这个过程通常通过对输入流的变换及增量计算来完成，所以在输入被完全消费之前，输出便产生了。因此，这里的**构件被称为过滤器**，这种风格的**连接件就像是数据流传输的管道**，将一个过滤器的输出传到另一过滤器的输入。

此风格特别重要的**过滤器必须是独立的实体，它不能与其他的过滤器共享数据，而且一个过滤器不知道它上游和下游的标识**。一个管道-过滤器网络输出的正确性并不依赖于过滤器进行增量计算过程的顺序。

> 一个典型的管道-过滤器体系结构的例子是以 Unix shell 编写的程序。Unix 既提供一种符号，以连接各组成部分(Unix 的进程)，又提供某种进程运行时机制以实现管道。
>
> 另一个著名的例子是传统的编译器。传统的编译器一直被认为是一种管道系统，在该系统中，一个阶段(包括词法分析、语法分析、语义分析和代码生成)的输出是另一个阶段的输入。

### 规则系统体系结构风格

规则系统体系结构风格是一个**使用模式匹配搜索来寻找规则**并在正确的时候应用正确的逻辑知识的虚拟机，其支持**把频繁变化的业务逻辑抽取出来，形成独立的规则库**。这些规则可独立于软件系统而存在，可被随时地更新。它提供了一种将专家解决问题的知识与技巧进行编码的手段，将**知识表示为“条件-行为”的规则**，当满足条件时，触发相应的行为，而不是将这些规则直接写在程序源代码中，**规则一般用类似于自然语言的形式书写**，无法被系统直接执行，故而**需要提供解释规则执行的“解释器”**。

## 构件

构件的特性是: (1)独立部署单元； (2)作为第三方的组装单元； (3)没有(外部的)可见状态。

一个构件可以包含多个类元素，但是一个类元素只能属于一个构件。

### 构件组装技术

构件组装技术大致可分为**基于功能的组装技术**、**基于数据的组装技术**和**面向对象的组装技术**。

### 基于构件的软件开发

基于构件的开发模型由软件的**需求分析定义**、**体系结构设计**、**构件库建立**、**应用软件构建**以及**测试和发布**5 个阶段组成。

基于构件的软件开发中，已有的构建分类方法可以归纳为三大类：

- 关键字分类法。根据领域分析的结果将应用领域的概念按照从抽象到具体的顺序逐次分解为树形或有向无回路图结构。
- 刻面分类法。利用 Facet(刻面)描述构件执行的功能、被操作的数据、构件应用的语境或任意其他特征。
- 超文本方法。基于全文检索技术，使得检索者在阅读文档过程中可以按照人类的联想思维方式任意跳转到包含相关概念或构件的文档。

### 软件复用

软件重用是指在两次或多次不同的软件开发过程中重复使用相同或相似软件元素的过程。

软件元素包括**程序代码**、**测试用例**、**设计文档**、**设计过程**、**需求分析文档**甚至**领域知识**。

通常，**可重用的元素也称作软构件**，可重用的软构件越大，重用的粒度越大。

软件复用分**垂直式复用**与**水平式复用**：

- 垂直式复用是指局限于某一垂直领域的重用，如只在电力系统中用到的构件；
- 水平式复用是指通用领域的复用，如标准函数库，任何软件都能用，所以是水平式复用。

#### 软件复用的好处

使用软件重用技术可以减少软件开发活动中大量的重复性工作，这样就能**提高软件生产率，降低开发成本，缩短开发周期**。同时，由于软构件大都经过严格的质量认证，并在实际运行环境中得到校验，因此，重用软构件**有助于改善软件质量**。此外，大量使用软构件，软件的**灵活性**和**标准化程度**也可望得到提高。

## 系统架构评估

## 软件架构评估过程

- 敏感点：是一个或多个**构件** (和或构件之间的关系) 的特性。
- 权衡点：是影响**多个质量属性**的特征，是多个质量属性的敏感点。
- 风险点：是指架构设计中**潜在的、存在问题**的架构决策所带来的隐患。
- 非风险点:：是指不会带来隐患，一般以“xxx 要求是可以实现 (或接受)的”方式表达。

### 质量属性

- Ping/Echo 主要提高系统的**可用性**；
- 限制访问主要提髙系统的**安全性**；
- 接口-实现分离、信息隐藏、运行时注册主要提高系统的**可修改性**；
- 主动冗余提高系统的**可靠性**；
- 队列调度主要提高系统的**性能**；
- 记录-回放主要提高系统的**可测试性**；

### 架构权衡分析方法(ATAM)

架构权衡分析方法是一种系统架构评估方法，主要**在系统开发之前**，针对性能、可用性、安全性和可修改性等质量属性进行评价和折中。ATAM 可以分为 4 个主要的活动阶段，包括**需求收集**、**架构视图描述**、**属性模型构造和分析**、**架构决策与折中**，整个评估过程**强调以属性作为架构评估的核心概念**。

#### 可用性的案例

“主站宕机后，系统能够在 10 秒内动切换至备用站点并恢复正常运行”主要与可用性质量属性相关，通常可采用 Ping/Edio、心跳、异常检测、主动冗余、被动冗余、检查点等架构策略实现该属性；

## 软件架构复用

软件架构复用主要分为两种类型：机会复用和系统复用。

### 机会复用

定义：指在软件开发过程中，一旦发现有可复用的资产，就立即对其进行复用。

应用场景：这种复用方式强调的是**在开发过程中灵活地识别和利用已有资源**。

### 系统复用

定义：涉及在软件开发之前的规划阶段，决定哪些组件或功能需要被复用。

应用场景：这种方法要求开发团队**在项目启动前就有清晰的复用计划**，以确保资源的高效利用。

> 理解：这里的”系统“应该是个形容词，是**系统性**的意思。系统性的复用，所以需要事先规划，有清晰的复用计划。

## UML

UML 对系统架构的定义是系统的组织结构，包括系统分解的组成部分，以及它们的关联性、交互机制和指导原则等提供系统设计的信息。具体来说，就是指以下 5 个系统视图：

1. 逻辑视图。逻辑视图也称为设计视图，它表示了设计模型中在架构方面具有重要意义的部分，即类、子系统、包和用例实现的子集。
2. 进程视图。进程视图是可执行线程和进程作为活动类的建模，它是逻辑视图的一次执行实例，描述了并发与同步结构。
3. 实现视图。实现视图对组成基于系统的物理代码的文件和构件进行建模。
4. 部署视图。部署视图把构件部署到一组物理节点上，表示软件到硬件的映射和分布结构。
5. 用例视图。用例视图是最基本的需求分析模型。

## 常用架构

### 特定领域软件架构(Domain Specific Software Architecture，DSSA)

特定领域软件架构(Domain Specific Software Architecture，DSSA)以一个特定问题领域为对象，形成由领域参考模型、参考需求、参考架构等组成的开发基础架构，其目标是支持一个特定领域中多个应用的生成。DSSA 的基本活动包括领域分析、领域设计和领域实现。其中领域分析的主要目的是获得领域模型，领域模型描述领域中系统之间共同的需求，即领域需求；领域设计的主要目标是获得 DSSA，DSSA 描述领域模型中表示需求的解决方案；领域实现的主要目标是依据领域模型和 DSSA 开发和组织可重用信息，并对基础软件架构进行实现。

### 基于架构的软件设计(Archiecture-Based Software Design，ABSD)方法

基于架构的软件设计(Archiecture-Based Software Design，ABSD)方法是架构驱动的方法，是一个**自顶向下**，**递归细化**的方法，软件系统的体系结构通过该方法得到细化，**直到能产生软件构件和类**。

## 软件生命周期

软件产品从形成概念开始，经过开发、使用和维护，直到最后退役的全过程成为软件生存周期。一个完整的软件生存周期是以需求为出发点，从提出软件开发计划的那一刻开始，直到软件在实际应用中完全报废为止。软件生存周期的提出了是为了更好地管理、维护和升级软件，其中更大的意义在于管理软件开发的步骤和方法。

软件生存周期模型又称软件开发模型(software develop model)或软件过程模型 (software process model),它是从某个特定角度提出的软件过程的简化描述。软件生存周期模型主要有**瀑布模型**、**演化模型**、**原型模型**、**螺旋模型**、**喷泉模型**和**基于可重用构件的模型**等。

### 瀑布模型

瀑布模型是最早使用的软件生存周期模型之一。瀑布模型的特点是因果关系紧密相连，前一个阶段工作的结果是后一个阶段工作的输入。或者说，每一个阶段都是建立在前一个阶段的正确结果之上，前一个阶段的错误和疏漏会隐蔽地带入后一个阶段。这种错误有时甚至可能是灾难性的，因此每一个阶段工作完成后，都要进行审查和确认。

### 演化模型

演化模型主要针对事先不能完整定义需求的软件开发，是在快速开发一个原型的基础上，根据用户在调用原型的过程中提出的反馈意见和建议，对原型进行改进，获得原型的新版本，重复这一过程，直到演化成最终的软件产品。演化模型的主要优点是，任何功能一经开发就能进入测试，以便验证是否符合产品需求，可以帮助引导出高质量的产品要求。其主要缺点是，如果不控制地让用户接触开发中尚未稳定的功能，可能对开发人员及永固都会产生负面的影响。

### 快速应用开发(Rapid Application Development，RAD)

快速应用开发(Rapid Application Development，RAD)是一种比传统生存周期法快得多的开发方法，它强调极短的开发周期。RAD 模型是**瀑布模型的一个高速变种**，通过**使用基于构件的开发方法**获得快速开发。如果需求理解得很好，且约束了项目范围，利用这种模型可以很快地开发出功能完善的信息系统。但是 RAD 也具有以下局限性：

1. 并非所有应用都适合 RAD。RAD 对模块化要求比较高，如果有哪一项功能不能被模块化，那么 RAD 所需要的构建就会有问题；如果高性能是一个指标，且该指标必须通过调整接口使其适应系统构件才能获得，则 RAD 也有可能不能奏效。
2. 开发者和客户必须在很短的时间完成一系列的需求分析，任何一方配合不当，都会导致 RAD 项目失败。
3. RAD 只能用于管理信息系统的开发，不适合技术风险很高的情况。例如，当一个新系统要采用很多新技术，或当新系统与现有系统有较高的互操作性时，就不适合使用 RAD。

## 软件开发

### 功用驱动开发方法

功用驱动开发方法(Feature Driven Development，FDD)致力于短时的迭代，阶段和可见可用的功能。在 FDD 中，编程开发人员分成首席程序员和“类”程序员(class owner)两类。

## 软件测试

### 测试种类

- **单元测试**的技术依据是**软件详细设计说明书**。
- **集成测试**的技术依据是**软件概要设计文档**。
- **系统测试**的技术依据是**用户需求或开发合同**。
- **配置项测试**的对象是软件配置项，配置项测试的目的是检验软件配置项与**软件需求规格说明**的一致性。
- **确认测试**主要验证软件的功能、性能和其他特性是否与**用户需求**一致。
- **验收测试**是指针对**软件需求规格说明**，在交付前以用户为主进行的测试。
- **回归测试**的目的是测试软件变更之后，**变更部分**的正确性和对变更需求的复合型，以及软件原有的、正确的功能、性能和其他规定的要求的不损害性。

## 系统可靠性

### 安全攸关(safety-critical)系统

安全攸关(safety-critical)系统是指系统失效会对生命或者健康构成威胁的系统，在航空、航天、汽车、轨道交通等领域存在大量的安全攸关系统。安全攸关系统中运行重要软件，其安全性要求很高。通常在开发安全攸关软件时，需求分析阶段必须考虑安全性需求，这里软件安全性需求是指通过约束软件的行为，使其不会出现不可接受的违反系统安全的行为需求。

### 单元测试

单元测试策略主要包括**自顶向下**的单元测试、**自底向上**的单元测试、**孤立测试**和**综合测试**策略。

#### 驱动模块和粧模块

测试一个模块时，可能需要为该模块编写一个驱动模块和若干个粧模块。

- 驱动模块用来**凋用被测模块**，它接收测试者提供的测试数据，并把这些数据传送给被测模块，然后从被测模块接收测试结果，并以某种可见的方式将测试结果返回给测试人员；

- 桩模块用來**模拟被测模块所调用的子模块**，它接受被测模块的调用，检验调用参数，并以尽町能简单的操作模拟被调用的子程序模块功能，把结果送回被测模块。
- **顶层模块测试时不需要驱动模块，底层模块测试时不要桩模块。**

### 系统测试

系统测试是将已经确认的软件、计算机硬件、外设和网络等其他因素结合在一起， 进行信息系统的各种集成测试和确认测试，**其目的是通过与系统的需求相比较，发现所开发的系统与用户需求不符或矛盾的地方**。

系统测试是根据**系统方案说明书**来设计测试用例，常见的系统测试主要有**恢复测试**、**安全性测试**、**压力测试**、**性能测试**、**可靠性测试**、**可用性测试**、**可维护性测试**和**安装测试**。

### 确认测试

根据用户的参与程度，通常包括以下 4 种类型：

- 内部确认测试。内部确认测试主要由软件开发组织内部按照软件需求规格说明书进行测试。
- α 测试和 β 测试。对于通用产品型的软件开发而言，α 测试是指由用户在开发环境下进行测试，通过 α 测试以后的产品通常称为 α 版；β 测试是指由用户在实际使用环境下进行测试，通过 β 测试的产品通常称为 β 版。一般在通过 β 测试后，才能把产品发布或交付给用户。
- 验收测试。验收测试是指针对软件需求规格说明书，在交付前以用户为主进行的测试。其测试对象为完整的、集成的计算机系统。验收测试的目的是，在真实的用户工作环境下，检验软件系统是否满足开发技术合同或软件需求规格说明书。验收测试的结论是用户确定是否接收该软件的主要依据。

### Web 服务器性能评估方法

常见的 Web 服务器性能评估方法有**基准测试**、**负载测试**、**压力测试**和**可靠性测试**等，评价 Web 服务器的主要性能指标有**最大并发连接数**、**响应延迟**和**吞吐量**等。当系统性能降到基本水平时，需要查找影响性能的瓶颈并消除该瓶颈。

## 软件维护

### 软件维护分类

在系统运行过程中，软件需要维护的原因是多样的。根据维护的原因不同，可以将软件维护分为以下 4 种：

1. 改正性维护。为了识别和纠正软件**错误**、改正软件性能上的**缺陷**、排除实施中的误使用，应当进行的诊断和改正错误的过程称为改正性维护。
2. 适应性维护。在使用过程中，外部**环境**(新的硬、软件配置)、数据环境(数据库、数据格式、数据输入/输出方法、数据存储介质)可能发生变化。为使软件适应这种变化而修改软件的过程称为适用性维护。
3. 完善性维护。在软件的使用过程中，用户往往会对软件提出**新的功能与性能要求**。为了满足这些要求，需要修改或再开发软件，以扩充软件功能、增强软件性能、改进加工效率、提髙软件的可维护性。这种情况下进行的维护活动成为完善性维护。
4. 预防性维护。指**预先提髙软件的可维护性、可靠性**等，为以后进一步改进软件打下良好基础。采用先进的软件工程方法对需要维护的软件或软件中的某一部分(重新)进行设计、编码和测试。

## 操作系统

### 微内核(Micro Kernel)

微内核(Micro Kernel)是现代操作系统普遍采用的架构形式。它是一种能够提供必要服务的操作系统内核，被设计成在很小的内存空间内增加移植性，提供模块设计，这些必要的服务包括任务、线程、交互进程通信以及内存管理等。而操作系统其他所有服务(含设备驱动)在用户模式下运行，可以使用户安装不同的服务接口(API)。

> 只提供核心服务，其他服务用户按需安装。

微内核的主要优点在于结构清晰、内核代码量少，安全性和可靠性高、可移植性强、可伸缩性、可扩展性高；其缺点是难以进行良好的整体优化、进程间互相通信的开销大、内核功能代码不能被直接调用而带来服务的效率低。

## 其他

### IDL

IDL 是一种接口定义语言，具体的定义会涉及到接口以及相关部分。文件包含的主要元素有：接口描述、模块定义、类型定义、常量定义、异常、值类型。接口描述是 IDL 文件中最核心的内容。

## JavaEE 技术术语

- EJB(Enterprise Java Beans) 是运行在独立服务器上的组件。
- COM+ 是 Microsoft 组件对象模型 (COM) 和 Microsoft Transaction Server (MTS) 的演变。COM+ 可用于开发适用于 Windows 的企业范围、任务关键型分布式应用程序。
- Servlet(Server Applet)是 Java Servlet 的简称，称为小服务程序或服务连接器。
- ASP 即 Active Server Pages，是 Microsoft 公司开发的服务器端脚本环境，可用来创建动态交互式网页并建立强大的 web 应用程序。

## 项目管理工具

项目管理工具用来辅助软件的项目管理活动。

通常项目管理活动包括**项目的计划、 调度、通信、成本估算、资源分配及质量控制等**。一个项目管理工具通常把重点放在某一个或某几个特定的管理环节上，而不提供对管理活动包罗万象的支持。

项目管理工具具有以下特征：

1. 覆盖整个软件生存周期；
2. 为项目调度提供多种有效手段；
3. 利用估算模型对软件费用和工作量进行估算；
4. 支持多个项目和子项目的管理；
5. 确定关键路径，松弛时间，超前时间和滞后时间；
6. 对项目组成员和项目任务之间的通信给予辅助；
7. 自动进行资源平衡；
8. 跟踪资源的使用；
9. 生成固定格式的报表和剪裁项目报告；

## 实时操作系统（RTOS）

实时系统的正确性依赖于运行结果的逻辑正确性和运行结果产生的时间正确性，即实时系统必须在规定的时间范围内正确地响应外部物理过程的变化。 实时多任务操作系统是根据操作系统的工作特性而言的。实时是指物理进程的真实时间。实时操作系统是指具有实时性，能支持实时控制系统工作的操作系统。首要任务是调度一切可利用的资源来完成实时控制任务，其次才着眼于提高计算机系统的使用效率，重要特点是要满足对时间的限制和要求。 一个实时操作系统可以在不破坏规定的时间限制的情况下完成所有任务的执行。任务执行的时间可以根据系统的软硬件的信息而进行确定性的预测。也就是说，如果硬件可以做这件工作，那么实时操作系统的软件将可以确定性的做这件工作。 实时操作系统可根据实际应用环境的要求对内核进行裁剪和重新配置，根据不同的应用，其组成有所不同。

### 任务

任务是 RTOS 中最重要的操作对象，每个任务在 RTOS 的调度下由 CPU 分时执行。任务的调度目前主要有时间分片式、轮流查询式和优先抢占式三种，不同的 RTOS 可能支持其中一种或几种，其中优先抢占式对实时性的支持最好。 在非实时系统中，调度的主要目的是缩短系统平均响应时间，提高系统资源的利用率，或优化某一项指标；而实时系统中调度的目的则是要尽可能地保证每个任务满足他们的时间约束，及时对外部请求做出响应。

### 并发执行的任务的相互关系：互斥与同步

由于资源共享与进程合作，并发执行的任务(进程)之间可能产生相互制约关系，这些制约关系可分为两类：竞争与协作。**并发进程之间的竞争关系为互斥，并发进程之间的协作关系体现为同步**。 同步是因合作进程之间协调彼此的工作而控制 S 己的执行速度，即因相互合作，相互等待而产生的制约关系。而互斥是进程之间竞争临界资源而禁止两个 y 上的进程同时进入临界区所发生的制约关系。 题目中一个任务要等待另一个任务发来消息，或建立某个条件后再向前执行，显然体现的制约关系是任务的同步。

## 数据挖掘

数据挖掘是从数据库的大量数据中揭示出隐含的、先前未知的并有潜在价值的信息的非平凡过程，数据挖掘的任务有**关联分析**、**聚类分析**、**分类分析**、**异常分析**、**特异群组分析**和**演变分析**等等。并非所有的信息发现任务都被视为数据挖掘。例如，使用数据库管理系统查找个别的记录，或通过因特网的搜索引擎查找特定的 Web 页面，则是信息检索领域的任务。虽然这些任务是重要的，可能涉及使用复杂的算法和数据结构，但是它们主要依赖传统的计算机科学技术和数据的明显特征来创建索引结构，从而有效地组织和检索信息。

## 企业信息集成

企业集成平台是一个支持复杂信息环境下信息系统开发、集成、协同运行的软件支撑环境，包括硬件、软件、软件工具和系统。基本功能包括：

1. 通信服务：提供分布环境下透明的同步/异步通信服务功能；
2. 信息集成服务：为应用提供透明的信息访问服务，实现异种数据库系统之间数据的交换、互操作、分布数据管理和共享信息模型定义：
3. 应用集成服务：通过高层应用编程接口来实现对相应应用程序的访问，能够为应用提供数据交换和访问操作，使各种不同的系统能够相互协作；
4. 二次开发工具：是集成平台提供的一组帮助用户开发特定应用程序的支持工具；
5. 平台运行管理工具：是企业集成平台的运行管理和控制模块。

## 数据库系统

[数据库系统](./数据库系统.md)
